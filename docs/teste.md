# Credo-ts Rest

Execução de testes no Credo-ts no modo REST

# Pré-requisito : 
### Executar o serviço REST conforme abaixo:

```
#cd packages
#yarn dev
```

## 1)Criar um identificado DID no endpoint /dids/create

### Executar o teste no botão "Try out" preenchendo o campo "Request body" conforme abaixo:

```
{
  "method": "ethr"
}
```
### Resposta com código 200 com o seguinte conteúdo: 

```
{
  "didDocumentMetadata": {},
  "didRegistrationMetadata": {},
  "didState": {
    "state": "finished",
    "did": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
    "didDocument": {
      "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://w3id.org/security/suites/secp256k1recovery-2020/v2"
      ],
      "id": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
      "verificationMethod": [
        {
          "id": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25#controller",
          "type": "EcdsaSecp256k1RecoveryMethod2020",
          "controller": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
          "blockchainAccountId": "eip155:1337:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25"
        }
      ],
      "authentication": [
        "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25#controller"
      ],
      "assertionMethod": [
        "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25#controller"
      ]
    },
    "secret": {
      "didKey": {
        "keyType": "k256",
        "publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
      }
    }
  }
}

```
### Observe que os valores gerados são:

```
"did": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25"
"publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
```

### Para teste com Curl

```
curl -X 'POST' \
  'http://localhost:3000/dids/create' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "method": "ethr"
}'
```

## 2) Registrar o schema no endpoint /AnonCreds/RegisterSchema

### Executar o teste no botão "Try out" preenchendo o campo "Request body" conforme abaixo:

```
{
  "schema": {
    "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
    "name": "schema-name",
    "version": "1.0",
    "attrNames": [
      "age"
    ]
  },
  "options": {
   "accountKey": {
     "keyType": "k256",
     "publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
   }
  }
}
```

### Resposta com código 200 com o seguinte conteúdo: 

```
{
  "schemaState": {
    "state": "finished",
    "schema": {
      "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
      "name": "schema-name",
      "version": "1.0",
      "attrNames": [
        "age"
      ]
    },
    "schemaId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0"
  },
  "registrationMetadata": {},
  "schemaMetadata": {}
}
```

### Observe que os valores gerados são:

```
"schemaId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0"
```

### Para teste com Curl:

```
curl -X 'POST' \
  'http://localhost:3000/anoncreds/schemas' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "schema": {
    "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
    "name": "schema-name",
    "version": "1.0",
    "attrNames": [
      "age"
    ]
  },
  "options": {
   "accountKey": {
     "keyType": "k256",
     "publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
   }
  }
}'
```

## 3) Registrar o schema no endpoint /anoncreds/credential-definitions

Executar o teste no botão "Try out" preenchendo o campo "Request body" conforme abaixo:

```
{
  "credentialDefinition": {
    "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
    "schemaId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0",
    "tag": "definition"
  },
  "options": {
     "supportRevocation": false,
     "accountKey": {
       "keyType": "k256",
       "publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
   }
  }
}
```

### Resposta com código 200 com o seguinte conteúdo: 

```
{
  "credentialDefinitionState": {
    "state": "finished",
    "credentialDefinition": {
      "schemaId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0",
      "type": "CL",
      "tag": "definition",
      "value": {
        "primary": {
          "n": "99618061198965423609876339887614370493873200625872448954689579596294621306928683259235247616993717470028867898748816387287308368042358042252225369460686639065387347796322842116796364395155934838431362570840391789604049208330586761416194388049955832923279896665948208682602717008449088935529374161827629511230356381929013060897440837298271364033637049922389367776798295099694172239269487811873294902192785366044019948814409441070742727111265341655541327070699017677017118054817380046215215726133005078758433961648327060505980532086934497783172543985805073785296656368482714506909814425310063890330687671375083734089433",
          "s": "16414988440045921013190723314860802080636656443152308607662624376708288637341099429427144992054958632968706361994411839954806701742992053009914169919305181681223891120717876047347826561812797838705173823538170661633719390171957297562551790104576091431231380564809510628675613299232046266211721199723691974558350892872651455951153482261633239933158311812184042839822119950577794772731207022075472062809526607726579881070772443244115498739131575195472278342243133336003161360606275434032112717199843853484465009467588883637842645847803346890273840129919995912491576182537921436831793987980245460043221824802426640926948",
          "r": {
            "master_secret": "18259402381007900115793833116192579414711066737181641271435278754090032934200931554645142755071308790537292726487237167244320060434289939480842446567410405890959822712545634888550556720125325627319611056061488439371634623919080010043701387397050483567218464027757841521610017127262185723086600353681870443801431041225507130717838274920722051305453079225150265963074770912531172843293075945654841785681177489598668824932961301063559978279295414167384646679368020785228691393347732603574786418735159166922274261519178373904475222932460246894861246523860531257613573070354726687767351606118923813591527152119247240081158",
            "age": "27187014398978037712592941809844013739186851914801606208065199128924677581560251940823238630463363486145894114652173210345326661893952837506656801900191634199629072447829180436491641621821273542457885836553908232824109854163005090923131250224943890145262059145208753302392852974894984037797599584214695100992491661131200796775494979317539877734867814443931417244904116150231754826006525389936462862030947644080122465677935691989438040937252710210256058941659582688149050227233990137634409304164915365869296674152839893391371148856284590297423539716080069259008689634678112012143755399439787055411794181038051175446914"
          },
          "rctxt": "2439918529044510887383498414430706249497300805456337760103013713163239257385974971723211755046989964923025943952523989204285410587469623021566601881811270588840920583310430246470822983583117960190279946862716894696532913616008144168057325071386452173897099952883699957754602622655483307485020535167669819686426754048366431925747836860718071628393248711599465770804207896173362256979947908795763063642876504113243616407813277842830717348894335858649041411431959656339101590939424941495390520357623430607411464039736321441509977698884465468004085452006110903085321921478797860136147611484380425650258110941038343861644",
          "z": "36139857644936496519130115390027155488595500780451664568690232805582676894516373079542281390334791575503362056769883075721503621891569517697711085404813197229832346264974991977361723327413647641360016718100495972733320115833654128195864464111059966293146325087527053272550740311338360044595497054728240088410740101800204905526750911011324917724186720232087301689539280209990352068586141261961808273354963064787339762895245059753384354919824208666335556305197808618584736343505584060654033246412699710562817077769261293583758745979765887457413418949366040905777551653383057868467779915382307567857557683952356737869143"
        }
      },
      "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25"
    },
    "credentialDefinitionId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/CLAIM_DEF/did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0/definition"
  },
  "registrationMetadata": {},
  "credentialDefinitionMetadata": {}
}

```

### Observe que os valores gerados são:
```
"credentialDefinitionId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/CLAIM_DEF/did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0/definition"

```

### Para teste com Curl:

```
curl -X 'POST' \
  'http://localhost:3000/anoncreds/credential-definitions' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "credentialDefinition": {
    "issuerId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25",
    "schemaId": "did:ethr:0xA20427CA7630b97A90c1866cc167A6E95B1eAc25/anoncreds/v0/SCHEMA/schema-name/1.0",
    "tag": "definition"
  },
  "options": {
     "supportRevocation": false,
     "accountKey": {
       "keyType": "k256",
       "publicKeyBase58": "xKMR83vpSoSyNro8SWTWdoY1Q6eNoWx4i6zmoUUyZzua"
   }
  }
}'
```
